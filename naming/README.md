## Module naming  

Terraform module designed to generate consistent label names and tags for resources. Use `naming` to implement a strict naming convention.

A label follows the following convention: `{service}_{project}_{environment}_{role}_{ext}_{attributes}`. The delimiter (e.g. `_`) is interchangeable.

It's recommended to use one `naming` module for every unique resource of a given resource type.
For example, if you have 10 instances, there should be 10 different labels.
However, if you have multiple different kinds of resources (e.g. instances, security groups, file systems, and elastic ips), then they can all share the same label assuming they are logically related.

## Usage

### Simple Example

Include this repository as a module in your existing terraform code:

```hcl
module "label" {
  source     = "../../"
  oe  = "azt"
  project      = "TestProj"
  environment  = "dev"
  service      = "ec2"
  role         = "myApp"
  ext          = "1"
  attributes = ["public", "2"]
  tags       = "${map("cost_center", "123456789", "Debitor", "70000001")}"
}
```

This will create the following output:
```hcl
attributes = public_2
environment = dev
id = ec2_testproj_ec1_dev_myapp_1_public_2
oe = azt
project = testproj
region = eu-central-1
role = myapp
service = ec2
tags = {
  Debitor = 70000001
  Environment = dev
  Name = ec2_testproj_ec1_dev_myapp_1_public_2
  OE = azt
  Project = testproj
  Region = eu-central-1
  Role = myapp
  cost_center = 123456789
}
```


Now reference the label when creating an instance (for example):

```hcl
resource "aws_instance" "eg_prod_bastion_public" {
  instance_type = "t1.micro"
  tags          = "${module.label.tags}"
}
```

Or define a security group:

```hcl
resource "aws_security_group" "eg_prod_bastion_public" {
  vpc_id = "${var.vpc_id}"
  name   = "${module.label.id}"
  tags   = "${module.label.tags}"
  egress {
    from_port   = 0
    to_port     = 0
    protocol    = "-1"
    cidr_blocks = ["0.0.0.0/0"]
  }
}
```



## Input

<!--------------------------------REQUIRE POSTPROCESSING-------------------------------->
|  Name |  Default  |  Description  |
|:------|:---------:|:--------------:|
| attributes |[] |Additional attributes (e.g. `policy` or `role`) add to the 'ID'|
| delimiter |"\_" |Delimiter to be used between `name`, `namespace`, `stage`, etc.|
| enabled |"true" |Set to false to prevent the module from creating any resources|
| oe |REQUIRED |Allianz OE e.g. "azt" for AZ Technology|
| project |Optional |Project Name used to separate projects of an AZ OE|
| environment |dev |Environment, e.g. 'prod', 'test', 'dev', or 'shared'|
| service | REQUIRED | AWS service, e.g 'sg' for security group or 'elb' for elastic load balancer |
| role | REQUIRED | Role or Scope of the Service, e.g. 'ldap' or application name like 'jenkins' |
| ext | Optional | extension to the full name, e.g. Sequenze or additional name |
| tags |{} |Additional tags (e.g. `map('BusinessUnit`,`XYZ`)|

**WARNING** Any tags passed as an input to this module will *override* the tags generated by this module.

## Output

<!--------------------------------REQUIRE POSTPROCESSING-------------------------------->
|  Name | Description  |
|:------|:------------:|
| attributes | Normalized attributes  |
| id | Disambiguated ID  |
| environment | Normalized environment  |
| oe | Normalized Allianz OE  |
| project | Normalized project  |
| region | Normalized region |
| role | Normalized Role or Scope |
| service | Normalized Service |
| tags | Merge input tags with our tags. Note: `Name` has a special meaning in AWS and we need to disamgiuate it by using the computed `id`   |

